---
import BaseLayout from "../../layouts/BaseLayout.astro";
import CaseStudyDetail from "../../components/react/CaseStudyDetail";
import {
  caseStudiesData,
  getAdjacentCaseStudies,
} from "../../data/caseStudiesData";

export function getStaticPaths() {
  return caseStudiesData.map((caseStudy) => ({
    params: { slug: caseStudy.slug },
    props: { caseStudy },
  }));
}

const { caseStudy } = Astro.props;
const { prev, next } = getAdjacentCaseStudies(caseStudy.slug);

const currentLanguage = "de";

// Schema Markup
const schema = JSON.stringify({
  "@context": "https://schema.org",
  "@type": "Article",
  headline: caseStudy.title,
  description: caseStudy.summary,
  image: caseStudy.ogImage
    ? `https://ki-automatisieren.de${caseStudy.ogImage}`
    : "https://ki-automatisieren.de/og-homepage.jpg",
  datePublished: "2024-01-15",
  dateModified: "2024-06-15",
  author: {
    "@type": "Person",
    name: "KI Automatisieren",
  },
  publisher: {
    "@type": "Organization",
    name: "KI Automatisieren",
    logo: {
      "@type": "ImageObject",
      url: "https://ki-automatisieren.de/logo.png",
    },
  },
  mainEntityOfPage: {
    "@type": "WebPage",
    "@id": `https://ki-automatisieren.de/fallstudien/${caseStudy.slug}`,
  },
});
---

<BaseLayout
  title={caseStudy.metaTitle || `${caseStudy.title} | Fallstudie`}
  description={caseStudy.metaDescription || caseStudy.summary}
  image={caseStudy.ogImage}
  type="article"
>
  <!-- Schema.org markup -->
  <script type="application/ld+json" set:html={schema} />

  <!-- Page Content -->
  <CaseStudyDetail
    client:load
    caseStudy={caseStudy}
    prev={prev}
    next={next}
    currentLanguage={currentLanguage}
  />
</BaseLayout>
