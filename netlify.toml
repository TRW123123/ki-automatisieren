# ===========================================
# NETLIFY CONFIGURATION - ki-automatisieren.de
# MINIMAL CONFIG - Debugging redirect loops
# Last updated: 2026-01-15
# ===========================================

[build]
  command = "npm run build"
  publish = "dist"

[build.environment]
  NODE_VERSION = "20"

# IMPORTANT: No redirects, no edge functions
# Astro handles trailing slashes via trailingSlash: 'always'
# Netlify should serve /blog/index.html for /blog/ requests

# ===========================================
# TXT/XML HARDENING - Crawler Entrypoints (P1 GSC FIX)
# These MUST return 200, NEVER redirect
# Added: 2026-01-15
# ===========================================
[[redirects]]
  from = "/robots.txt"
  to = "/robots.txt"
  status = 200
  force = true

[[redirects]]
  from = "/sitemap-index.xml"
  to = "/sitemap-index.xml"
  status = 200
  force = true

# Only the critical index.html â†’ / redirect
[[redirects]]
  from = "/index.html"
  to = "/"
  status = 301
  force = true
